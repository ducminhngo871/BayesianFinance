---
title: "Checkpoint3"
author: "NicholasDi"
date: "11/18/2021"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

```{r}
library(tidyverse)         # for reading in data, graphing, and cleaning
library(tidymodels)        # for modeling ... tidily
library(usemodels)         # for suggesting step_XXX() functions
library(glmnet)            # for regularized regression, including LASSO
library(naniar)            # for examining missing values (NAs)
library(lubridate)         # for date manipulation
library(moderndive)        # for King County housing data
library(vip)               # for variable importance plots
library(rmarkdown)         # for paged tables
library(dplyr)
library(janitor)
library(ggplot2)
library(dplyr)
```

```{r}
#Loading Dataset 
data <- read.csv("FINALDATASET.csv")
```

#1. Introducing your data

Write an introductory paragraph about your data. This should include your data source(s), a narrative description of how/when/why/by whom these data were collected, and a codebook or table describing the variables you plan to use in your analysis.

#2. Data summaries

Demonstrate that you have the data imported and ready to go in RStudio. Specifically, to each dataset,applyandincludetheoutputforthefollowingfunctions:dim(), names(), head(), summary(). You do not need to write anything.

```{r}
dim(data)
names(data)
head(data)
summary(data)
```

#3 Data viz

In your final report, elements such as data visualization will be just as important as the models you build. Construct and discuss a series of 4 data visualizations that inform your research questions. Combined, these viz should:
• tell a story and follow a natural progression, starting with simple univariate plots and ending with multivariate plots;
• help the readers better understand the structure of your data; and
• inform the next step in your analysis: model building.

```{r}
#First Viz
tabyl(data$YEAR) %>% 
  ggplot(aes(x= `data$YEAR`, y = n)) +
  geom_line()+
  xlab("")+
  ylab("") + 
  labs(title = "Number of Companies Within the Period") + 
  theme_minimal()

#Second Viz 
sumUSA <- data %>% 
  group_by(YEAR) %>% 
  summarise(sumMarket_cap = sum(`MARKET.CAP`), 
            sumEarnings = sum(EARNINGS), 
            sumCOGS = sum(COGS), 
            sumSALES = sum(SALES), 
            sumCASH = sum(CASH), 
            sumInvestments = sum(INVESTMENTS), 
            sumReceivable = sum(RECEIVABLE), 
            sumInventory = sum(INVENTORY), 
            sumDebts = sum(DEBTS)) 

sumUSA %>% 
  ggplot(aes(x = YEAR, y = sumMarket_cap)) + geom_line() +labs(x = "Year")+
  ggtitle("Market Cap within Dataset")

#Third Viz
temp <- data %>% 
  group_by(COMPANY) %>% 
  summarize(count = n(), 
            mean_MC = mean(MARKET.CAP)) %>% 
  filter(count == 23) %>% 
  arrange(desc(mean_MC)) %>% 
  head(50)
temp <- temp$COMPANY

data_2 <- data %>%  
  filter(COMPANY %in% temp) 


```


#4 Model building
Build and analyze 1–3 Bayesian models which will help inform your research questions. (Build- ing 1 model will be worth full credit, but you’re encouraged to go beyond 1 model if possible.) Keep in mind:
• Scaffolding is important! Model 1 should be the simplest model you can think of. You can build up from there, adding extra parameters/terms/layers as needed. THINK: is Y quantitative? Categorical? What’s a reasonable likelihood structure for our model? Are the data grouped?
• For each model, define notation, specify the model, provide a brief model interpretation (eg: what do the parameters mean).
• For each model, simulate the posterior in R and briefly summarize your conclusions.



